<!DOCTYPE html>

<html lang="it">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Gestione Emergenze - CRI</title>
<link href="manifest.json" rel="manifest"/>
<meta content="#b71c1c" name="theme-color"/>
<link href="assets/css/app.css" rel="stylesheet"/> <link href="assets/css/pages/emergenze.css" rel="stylesheet"/>
</head>
<body class="layout-admin">
<aside aria-label="Navigazione principale" class="sidebar">
<img alt="Logo Croce Rossa Italiana" id="logo-cri" src="logo.svg"/>
<ul aria-label="Menu principale" class="menu" id="menu-sidebar" role="navigation"></ul>
<button id="logout" type="button">Logout</button>
</aside>
<main class="main">
<h1 id="pageTitle">ğŸš¨ Gestione Emergenze</h1>
<div class="toolbar">
<input aria-label="Cerca emergenza" id="search" placeholder="ğŸ” Cerca per titolo, comitato, luogo o stato" type="search"/>
<button id="btn-apri-form">â• Nuova Emergenza</button>
</div>
<table aria-label="Elenco emergenze">
<thead>
<tr>
<th scope="col">Titolo</th>
<th scope="col">Inizio</th>
<th scope="col">Comitato Creatore</th>
<th scope="col">Destinatari</th>
<th scope="col">SeveritÃ </th>
<th scope="col">Stato</th>
<th scope="col">Contributi</th>
<th scope="col">Azioni</th>
</tr>
</thead>
<tbody id="emergenze-list"></tbody>
</table>
</main>
<!-- MODALE CREA/MODIFICA EMERGENZA -->
<div aria-hidden="true" class="modal-overlay" id="form-container">
<div aria-labelledby="form-title" aria-modal="true" class="modal-box" id="form-box" role="dialog">
<button aria-label="Chiudi Modulo" class="modal-close" id="btn-chiudi-form">Ã—</button>
<h2 id="form-title" style="color: var(--rosso-cri); margin-top:0;">Crea/Modifica Emergenza</h2>
<form autocomplete="off" id="emergenze-form" novalidate="">
<div class="row">
<input id="titolo" name="titolo" placeholder="Titolo emergenza *" required="" type="text"/>
<input id="tipo" name="tipo" placeholder="Tipo (es. incendio, alluvione, incidente...) *" required="" type="text"/>
</div>
<div class="row">
<input id="luogo" name="luogo" placeholder="Luogo (indirizzo o area) *" required="" type="text"/>
<select aria-label="SeveritÃ  emergenza" id="livello" name="livello" required="">
<option selected="" value="">SeveritÃ  (S1/S2/S3) *</option>
<option value="S1">S1 - bassa</option>
<option value="S2">S2 - media</option>
<option value="S3">S3 - alta</option>
</select>
</div>
<div class="row">
<input id="dataInizio" name="dataInizio" required="" type="date"/>
<input id="oraInizio" name="oraInizio" required="" type="time"/>
</div>
<div class="row">
<input id="referente" name="referente" placeholder="Referente / Caposquadra (opzionale)" type="text"/>
<input id="comitatoCreatore" name="comitatoCreatore" placeholder="Comitato creatore *" readonly="" required="" type="text"/>
</div>
<div class="row">
<textarea id="descrizione" name="descrizione" placeholder="Descrizione emergenza, attivitÃ , note operative *" required=""></textarea>
</div>
<fieldset style="margin: 10px 0; border: 1px solid #ccc; padding: 10px; background:#fff; border-radius:10px;">
<legend><b>Estensione emergenza</b></legend>
<p style="font-size:0.9rem; margin-top:0; color:#444;">
          Seleziona uno o piÃ¹ destinatari. Puoi usare clic singolo per attivare/disattivare un'opzione.
          Se non selezioni nulla, lâ€™emergenza resta visibile solo al comitato creatore. Ogni destinatario dovrÃ  <b>approvare</b> prima di poter aggiungere i propri mezzi/materiali/log.
        </p>
<div class="row">
<select id="destinatariComitati" multiple="" name="destinatariComitati" style="flex:1 1 100%; min-height: 130px;">
<!-- popolato da JS -->
</select>
</div>
</fieldset>
<div class="row">
<select aria-label="Stato emergenza" id="stato" name="stato">
<option value="attiva">Attiva</option>
<option value="chiusa">Chiusa</option>
</select>
<div class="muted" style="flex:1 1 48%; display:flex; align-items:center;">
          Nota: qui definisci i dati dellâ€™emergenza. I contributi (mezzi/materiali/volontari/log)
        </div>
</div>
<button id="submit-btn" type="submit">Salva Emergenza</button>
</form>
</div>
</div>
<!-- POPUP INFO -->
<div aria-hidden="true" aria-labelledby="info-title" aria-modal="true" id="info-popup" role="dialog" tabindex="-1">
<button aria-label="Chiudi dettagli emergenza" id="info-close">Ã—</button>
<h3 id="info-title">ğŸš¨ Dettagli Emergenza</h3>
<div id="info-content"></div>
</div>
<!-- MODALE GESTIONE RISORSE DEL COMITATO -->
<div aria-hidden="true" class="modal-overlay" id="res-container">
<div aria-labelledby="res-title" aria-modal="true" class="modal-box" id="res-box" role="dialog">
<button aria-label="Chiudi Risorse" class="modal-close" id="res-close">Ã—</button>
<h2 id="res-title" style="color: var(--rosso-cri); margin-top:0;">ğŸ§° Risorse del comitato</h2>
<div class="row" id="res-committee-row" style="margin-bottom:10px; display:none;">
<select aria-label="Seleziona comitato (solo SOP/Admin/TLC)" id="resCommitteeSelect"></select>
<div class="muted" style="flex:1 1 48%; display:flex; align-items:center;">
        Seleziona il comitato per cui stai inserendo il contributo.
      </div>
</div>
<div class="resources">
<div class="resources-header">
<div><b style="color:var(--rosso-cri)">Seleziona risorse</b></div>
<div class="segmented" role="tablist">
<button aria-selected="true" class="active" id="tab-mezzi" role="tab" type="button">ğŸš— Mezzi</button>
<button aria-selected="false" id="tab-materiali" role="tab" type="button">ğŸ“¦ Materiali</button>
<button aria-selected="false" id="tab-volontari" role="tab" type="button">ğŸ‘¥ Volontari</button>
</div>
</div>
<div class="resources-body">
<div class="resources-tools">
<input aria-label="Cerca risorse" id="res-search" placeholder="ğŸ” Filtra risorse..." type="search"/>
<button class="mini-btn" id="btn-clear-res" type="button">ğŸ§¹ Pulisci</button>
<button class="mini-btn" id="btn-select-all-mezzi" type="button">âœ… Tutti i mezzi</button>
<button class="mini-btn" id="btn-select-all-vol" type="button">âœ… Tutti i volontari</button>
</div>
<div class="chips" id="selected-chips"></div>
<div id="panel-mezzi" role="tabpanel">
<div class="cards" id="mezzi-cards"></div>
</div>
<div id="panel-materiali" role="tabpanel" style="display:none;">
<div class="cards" id="materiali-cards"></div>
</div>
<div id="panel-volontari" role="tabpanel" style="display:none;">
<div class="cards" id="volontari-cards"></div>
</div>
</div>
</div>
<div style="margin-top:14px; display:flex; gap:10px; flex-wrap:wrap;">
<button class="action-btn ok-btn" id="btn-save-res" type="button">ğŸ’¾ Salva contributo</button>
<button class="action-btn no-btn" id="btn-cancel-res" type="button">Annulla</button>
</div>
</div>
</div>
<!-- MODALE LOG INTERVENTI DEL COMITATO -->
<div aria-hidden="true" class="modal-overlay" id="log-container">
<div aria-labelledby="log-title" aria-modal="true" class="modal-box" id="log-box" role="dialog">
<button aria-label="Chiudi Log" class="modal-close" id="log-close">Ã—</button>
<h2 id="log-title" style="color: var(--rosso-cri); margin-top:0;">ğŸ“ Intervento / Turno (per comitato)</h2>
<form autocomplete="off" id="log-form" novalidate="">
<div class="row">
<input id="logStart" name="logStart" required="" type="datetime-local"/>
<input id="logEnd" name="logEnd" required="" type="datetime-local"/>
</div>
<div class="row">
<input id="logAttivita" name="logAttivita" placeholder="AttivitÃ  (es. trasporto, supporto...) *" required="" type="text"/>
<input id="logResponsabile" name="logResponsabile" placeholder="Responsabile turno (opzionale)" type="text"/>
</div>
<div class="row">
<textarea id="logNote" name="logNote" placeholder="Note / dettagli operativi (opzionale)"></textarea>
</div>
<div class="section-title">ğŸ‘¥ Volontari del tuo comitato</div>
<div class="row">
<select id="logVolontari" multiple="" style="flex:1 1 100%; min-height:150px;"></select>
</div>
<div class="section-title">ğŸš— Mezzi del tuo contributo</div>
<div class="row">
<select id="logMezzi" multiple="" style="flex:1 1 100%; min-height:120px;"></select>
</div>
<div class="section-title">ğŸ“¦ Materiali (quantitÃ  usata nel turno)</div>
<div class="row">
<div id="logMaterialiWrap" style="flex:1 1 100%; background:#fff; border:1px solid #ddd; border-radius:10px; padding:12px;"></div>
</div>
<button id="log-submit" style="margin-top:12px;" type="submit">Salva Intervento</button>
</form>
</div>
</div>
<script defer src="assets/js/pages/emergenze.js?v=20260128"></script>
</body>
</html>
